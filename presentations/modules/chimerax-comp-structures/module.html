<section>
<h1 style="font-size:160%">Structure Analysis and Comparison</h1>
	<ul>
		<li>Structure analysis:
			<ul>
				<li>Hydrogen bonds and contacts</li>
				<li>Amino acid sidechain conformations (rotamers)</li>
				<li>Properties (B-factor, hydrophobicity, <i>etc.</i>)</li>
			</ul>
		</li>
		<li>Structural comparison:
			<ul>
				<li>Superimposing structures</li>
				<li>Morphing between structures</li>
			</ul>
		</li>
	</ul>
	<!--
	<p>
	This tutorial includes binding site analysis and comparison of related
	structures by superposition and morphing. Internet connectivity is required 
	to fetch the structures <b>3w7f</b> and <b>2zco</b>.
	<ul>
		<li><a href="#setup">Background and Setup</a></li>
		<li><a href="#dists">Distances, H-Bonds, Contacts</a></li>
		<li><a href="#angles">Angles, Rotamers, Clashes</a></li>
		<li><a href="#surfaces">Surfaces and Attributes</a></li>
		<li><a href="#comparison">Superposition and Morphing</a></li>
	</ul>
	</p>
	-->
</section>

<section id="setup">
	<h1>Background</h1>
	<div style="height:850px">
<p style="font-size:80%">
The pathogenic organism <i>Staphylococcus aureus</i> makes a
pigment called staphyloxanthin.  The pigment imparts a golden color 
(hence <i>aureus</i>), but more importantly, contributes to virulence 
by protecting the bacteria from being killed by the host immune system.
The <i>S. aureus</i> enzyme CrtM may be a good drug target 
because it catalyzes a key step in staphyloxanthin synthesis:
<blockquote style="font-size:70%;margin-left:50px;width:1100px">
<a href="https://www.ncbi.nlm.nih.gov/pubmed/18276850" target="_blank">
A cholesterol biosynthesis inhibitor blocks <i>Staphylococcus aureus</i>
virulence.</a>
Liu CI, Liu GY, Song Y, Yin F, Hensler ME, Jeng WY, Nizet V, 
Wang AH, Oldfield E.
<i>Science.</i> 2008 Mar 7;319(5868):1391-4.
</blockquote>
<p style="font-size:80%">
We will view and compare different structures of this enzyme.
</p>
	</div>
</section>

<section>
	<h1>Setup</h1>
	<div style="height:850px">
	<ol style="font-size:90%">
		<li>Launch ChimeraX</li>
		<li>Show the <b>Side View</b> by clicking 
<img width="35px" src="modules/chimerax-comp-structures/sideview.png"/> in the 
<a href="https://www.rbvi.ucsf.edu/chimerax/docs/user/tools/graphics.html" target="_none"><b>Graphics</b></a> 
tab of the toolbar, or using the menu (<b>Tools... General... Side View</b>),
or using a command:
			<blockquote>
				<i>Command</i>:&nbsp;<b><a href="cxcmd:tool show 'Side View'">tool show "Side View"</a></b>
			</blockquote>
		</li>
		<li>Fetch the structure from the <a href="https://www.rcsb.org" target="_blank">Protein Data Bank</a>:
		<blockquote>
			<i>Command</i>:&nbsp;<b><a href="cxcmd:open 3w7f">open 3w7f</a></b>
		</blockquote>
		The protein is shown as ribbons, with ligands and nearby residues as sticks. 
		</li>
		<li>There are two copies of the enzyme, chains A and B. Delete chain B:
			<blockquote>
				<i>Command</i>:&nbsp;<a href="cxcmd:delete /b"><b>delete /b</b></a>
			</blockquote>
		</li>
	</ol>
	</div>
</section>

<section>
	<h1>Setup</h1>
			<img class="plain" width="80%"src="modules/chimerax-comp-structures/3w7fA.png"/>
</section>

<section>
	<h1>Setup</h1>
	<div style="height:850px">
		<p style="font-size; 80%">
The enzyme combines two 15-carbon molecules of farnesyl pyrophosphate
to form a 30-carbon lipid.  This structure contains 
farnesyl <b><i>thio</i></b>pyrophosphate, 
which differs from the substrate by having a sulfur (yellow) in the place of one
oxygen.
		<ol start="5" style="width:1100px;text-align:left;">
			<li>Focus the view on the ligand residues and label them:
<blockquote>
	<i>Command</i>:&nbsp;<b><a href="cxcmd:view ligand">view ligand</a></b>
	<br><i>Command</i>:&nbsp;<b><a href="cxcmd:label ligand">label ligand</a></b>
</blockquote>
Label height is 0.7&Aring; by default, but can be changed, for example:
<blockquote>
	<i>Command</i>:&nbsp;<b><a href="cxcmd:label height 1.0">label height 1.0</a></b>
</blockquote>
			</li>
		</ol>
	</div>
</section>

<section>
	<h1>Setup</h1>
	<div style="height:850px">
		<p style="font-size:80%">
In this structure, the farnesyl thiopyrophosphate molecules are named FPS.
Three magnesium ions help to offset the negative charges on the phosphates.
The ions are shown as greenish spheres; clicking into the ChimeraX window
and hovering the mouse cursor over each shows information in a pop-up
balloon.  Metal coordination bonds from FPS, water, and the protein 
are shown with dashed purple lines.
Lines drawn to indicate interactions other than
covalent bonds are called <b><i>pseudobonds</i></b>.
Hovering the cursor over a pseudobond or bond shows balloon information 
about its end atoms and length.
</p>
	</div>
</section>

<section>
	<h1>Setup</h1>
	<div style="width:400px;float:right;margin-top:50px">
			<img class="plain" src="modules/chimerax-comp-structures/labels.png"/>
	</div>
	<div style="height:850px;width:800px">
<br/>
		<ol start="6" style="font-size:80%;width:900px">
			<li>Although water could be included in the various analyses, <br/>
remove it to simplify the tutorial:
<blockquote style="text-align:left;margin-left:10px">
	<i>Command</i>:&nbsp;<b><a href="cxcmd:delete solvent">delete solvent</a></b>
</blockquote>
			<li>Label the residues with sidechains shown:
<blockquote style="text-align:left;margin-left:10px">
<i>Command</i>:&nbsp;<b><a href="cxcmd:label @@display">label @@display</a></b>
</blockquote>
In this command, <b>@@display</b> refers to an atom-level attribute
named <b>display</b> that indicates whether the atom is displayed. 
Essentially, the command is saying: 
&ldquo;label all residues with displayed atoms.&rdquo;
			</li>
</ol>
	</div>
</section>

<section id="dists">
	<h1>Distances, H-Bonds, Contacts</h1>
	<div style="width:400px;float:right;margin-top:50px">
			<img class="plain" src="modules/chimerax-comp-structures/distance.png"/>
	</div>
	<div style="height:850px; width:800px;font-size:80%">
		<p>It looks like several sidechains could be donating hydrogen bonds to phosphate 
		oxygens. (Although the structure does not include hydrogens, we know they are there!) </p>
		<p> One of the displayed residues is Ser 21. To measure a distance: 
		<ol>
			<li>Ctrl-click to pick the sidechain oxygen of Ser 21</li>
			<li>Shift-Ctrl-doubleclick on the nearest phosphate oxygen</li>
			<li>click <b>Distance</b> in the resulting context menu </li>
		</ol>
		</p>
		<p>Similarly, measure the distance between the sidechain oxygen of Tyr 248 and the same phosphate oxygen. Equivalent commands would be:
<blockquote>
	<i>Command</i>:&nbsp;<b><a href="cxcmd:distance :21@OG :302@O1B">distance :21@OG :302@O1B</a></b>
<br>
	<i>Command</i>:&nbsp;<b><a href="cxcmd:distance :248@OH :302@O1B">distance :248@OH :302@O1B</a></b>
</blockquote>
		</p>
	</div>
</section>

<section>
	<h1>Distances, H-Bonds, Contacts</h1>
	<div style="width:400px;height:400px;float:right;margin-top:0px">
			<img class="plain" src="modules/chimerax-comp-structures/hbond.png"/>
	</div>
	<div style="height:400px; width:800px; font-size:80%">
<p>
Distance measurements are shown as yellow dashed pseudobonds.
		The distances seem consistent with hydrogen bonds. However, rather than measuring many 
		distances and trying to remember the appropriate hydrogen-bonding distances for different 
		types of atoms, you can just use the 
		<b><a href="https://www.rbvi.ucsf.edu/chimerax/docs/user/commands/hbonds.html" target="_none">hbonds</a></b> 
		command 
or <b><a href="https://www.rbvi.ucsf.edu/chimerax/docs/user/tools/hbonds.html" target="_none">H-Bonds</a></b> tool.
	</div>
</section>

<section>
	<h1>Distances, H-Bonds, Contacts</h1>
	<div style="height:500px; font-size:80%">
		<ol>
			<li>To limit the H-bond search, first select the FPS residues: 
			<blockquote style="text-align:left;margin-left:10px;font-size:90%">
				<i>Command</i>:&nbsp;<b><a href="cxcmd:select :FPS">select :FPS</a></b>
			</blockquote>
(or menu: <b>Select... Residues... FPS</b>)
			</li>
			<li>Find H-bonds with one end selected, and report the results in the <b>Log</b>:
			<blockquote style="text-align:left;margin-left:10px;font-size:90%">
				<i>Command</i>:&nbsp;<b><a href="cxcmd:hbonds sel restrict cross reveal true log true">hbonds sel restrict cross reveal true log true</a></b>
			</blockquote>
The same thing could be done using the
<b><a href="https://www.rbvi.ucsf.edu/chimerax/docs/user/tools/hbonds.html" target="_none">H-Bonds</a></b> tool
(menu: <b>Tools... Structure Analysis... H-Bonds</b>)
with options checked to <b>Reveal atoms of H-bonding residues</b>,
<b>Limit by selection: with exactly one end selected</b>,
and <b>Log</b>, other settings default.
			</li>
		</ol>
	</div>
</section>

<section>
	<h1>Distances, H-Bonds, Contacts</h1>
	<div style="height:850px; font-size:80%">
		<p>The H-bonds are shown as light blue dashed pseudobonds.
		The two measured distances were found to be consistent with hydrogen bonding. 
		Details can be viewed in the <b>Log</b>. </p>
		<p>Remove the “hydrogen bond” pseudobonds:
			<blockquote style="text-align:left;margin-left:10px;font-size:90%">
				<i>Command</i>:&nbsp;<b><a href="cxcmd:~hbonds">~hbonds</a></b>
			</blockquote>
			<p style="margin-top:0px;margin-bottom:0px">Remove the distance measurements:</p>
			<blockquote style="text-align:left;margin-left:10px;font-size:90%">
				<i>Command</i>:&nbsp;<b><a href="cxcmd:~distance">~distance </a></b>
			</blockquote>
		</p>
	</div>
</section>

<section>
	<h1>Distances, H-Bonds, Contacts</h1>
	<div style="height:850px; font-size:80%">
		<p>
<b><a href="https://www.rbvi.ucsf.edu/chimerax/docs/user/tools/clashes.html" target="_none">Clashes/Contacts</a></b>
	 	is similar to 
<b><a href="https://www.rbvi.ucsf.edu/chimerax/docs/user/tools/hbonds.html" target="_none">H-Bonds</a></b>
	 	but can also identify nonpolar interactions:
		<ul style="padding:10px 50px">
			<li><i><b>clashes</b></i> &ndash; unfavorable interactions where atoms are too close together; close contacts</li>
			<li><i><b>contacts </b></i> &ndash; all kinds of direct interactions: polar and nonpolar, 
				favorable and unfavorable, including clashes</li>
		</ul>
	</div>
</section>

<section>
	<h1>Distances, H-Bonds, Contacts</h1>
	<div style="width:400px;height:300px;float:right;margin-top:0px">
			<img class="plain" src="modules/chimerax-comp-structures/contacts.png"/>
	</div>
	<div style="height:850px; font-size:80%">
		<p>We will identify contacts of the FPS residues.  Make sure the FPS residues 
		are still selected, then execute the 
		<a href="https://www.rbvi.ucsf.edu/chimerax/docs/user/commands/clashes.html" target="_none">contacts</a> command:
			<blockquote style="text-align:left;margin-left:10px;font-size:90%">
				<i>Command</i>:&nbsp;<b><a href="cxcmd:contacts sel restrict cross reveal t log t select t">
					contacts sel restrict cross reveal t log t select t</a></b>
			</blockquote>
		</p>
<p>(This could also be done with the
<b><a href="https://www.rbvi.ucsf.edu/chimerax/docs/user/tools/clashes.html" target="_none">Contacts</a></b> tool, in the menu under <b>Tools... Structure Analysis</b>.)
		<p>In the <b>Log</b>, the atom-atom contacts are listed in order of decreasing 
		VDW <b><i>overlap</i></b>: 
positive where the atomic VDW spheres are intersecting, 
zero if just touching, negative if separated by space. 
		By default, slightly separated spheres are still considered contacts. Distances 
		between the atomic centers are also given. </p>
<p>
We will use the atoms selected by the command to get a list 
of the contacting residues.
</p>
	</div>
</section>

<section>
	<h1>Distances, H-Bonds, Contacts</h1>
	<div style="height:850px; font-size:80%">
		<p>The <b>Log</b> lists the details of each atomic contact, but one might want a simpler list of interacting residues instead.
		First, deselect everything that is not protein:
			<blockquote style="text-align:left;margin-left:10px;font-size:90%">
				<i>Command</i>:&nbsp;<b><a href="cxcmd:~sel ~protein">~sel&nbsp;&nbsp;~protein</a></b><br/>
			</blockquote>
		</p>
		<p>Now list the selected residues in the <b>Log</b> using the <b>
			<a href="https://www.rbvi.ucsf.edu/chimerax/docs/user/commands/info.html#residues" target="_none">info residues</a></b>
		command:</p>
			<blockquote style="text-align:left;margin-left:10px;font-size:90%">
				<i>Command</i>:&nbsp;<b><a href="cxcmd:info residues sel">info residues sel</a></b>
			</blockquote>
<p>
You can see Ser 21, Tyr 248, and several others in the list.
To clean up for the next section, remove the contact pseudobonds
and clear the selection:
			<blockquote style="text-align:left;margin-left:10px;font-size:90%">
				<i>Command</i>:&nbsp;<b><a href="cxcmd:~contacts">~contacts</a></b>
				<br><i>Command</i>:&nbsp;<b><a href="cxcmd:select clear">select clear</a></b>
			</blockquote>
	</div>
</section>

<section id="angles">
	<h1>Angles, Rotamers, Clashes</h1>
	<div style="height:850px; font-size:80%">
		<p>Focus the view on Tyr 248:
			<blockquote style="text-align:left;margin-left:10px;font-size:90%">
				<i>Command</i>:&nbsp;<b><a href="cxcmd:view :248">view :248</a></b>
                        </blockquote>
		<p>Ctrl-click to select any atom in Tyr 248, then press the up arrow key on the keyboard to promote the selection to the whole residue (if the initial selection is a bond instead of an atom, you will need to press the up arrow twice).
Alternatively, you can select the whole residue with the following command:
<blockquote style="text-align:left;margin-left:10px;font-size:90%">
                                <i>Command</i>:&nbsp;<b><a href="cxcmd:select :248">select :248</a></b>
                        </blockquote>
</section>

<section>
	<h1>Angles, Rotamers, Clashes</h1>
	<div style="height:850px; font-size:80%">
<p>
We will set up clash checking and rotate the sidechain interactively.
Start the 
<b><a href="https://www.rbvi.ucsf.edu/chimerax/docs/user/tools/clashes.html" target="_none">Clashes</a></b> tool 
from the menu under <b>Tools... Structure Analysis</b>, or use the command:
			<blockquote style="text-align:left;margin-left:10px;font-size:90%">
				<i>Command</i>:&nbsp;<b><a href="cxcmd:tool show Clashes">tool show Clashes</a></b>
			</blockquote>
<p>
In the <b>Clashes</b> dialog, keep most options as defaults, except:
<ul>
<li>Turn on the option to <b>Limit by selection</b>, set to: <b>with exactly one atom selected</b>
<li>Turn on the option to <b>Reveal atoms...</b> 
<li>Set the <b>Frequency of checking</b> to 
<b>continuously (until dialog closed)</b>
<br>(...and do not <b>Close</b> the dialog yet, although it can be moved aside)
</ul>
<p>
Alternatively, this setup could be done with the command:
<blockquote style="text-align:left;margin-left:10px;font-size:90%">
                                <i>Command</i>:&nbsp;<b><a href="cxcmd:clashes sel restrict cross reveal t continuous t">clashes sel restrict cross reveal t continuous t</a></b>
                        </blockquote>
<p>
As reported in the <b>Log</b>,
no clashes with Tyr 248 are found in its initial position.
</section>

<section>
	<h1>Angles, Rotamers, Clashes</h1>
	<div style="height:850px; font-size:80%">
<p>
Measure the sidechain chi1 and chi2 angles of Tyr 248:
			<blockquote style="text-align:left;margin-left:10px;font-size:90%">
				<i>Command</i>:&nbsp;<b><a href="cxcmd:torsion :248@n,ca,cb,cg">torsion :248@n,ca,cb,cg</a></b>
				<br><i>Command</i>:&nbsp;<b><a href="cxcmd:torsion :248@ca,cb,cg,cd1">torsion :248@ca,cb,cg,cd1</a></b>
			</blockquote>
<p>
The <b>Log</b> reports chi1 and chi2 as 
&ndash;106.801&deg; and &ndash;142.054&deg;, respectively.
</section>
<section>
	<h1>Angles, Rotamers, Clashes</h1>
	<div style="height:850px; font-size:80%">
<p>
Set the function of the right mouse button 
(= trackpad + Alt on Windows, trackpad + 
<img class="plain" width="20px" src="modules/chimerax-comp-structures/icon-clover.png"> on Mac) 
to bond rotation by clicking
<img width="35px" src="modules/chimerax-comp-structures/bondrot.png"/> in the 
<a href="https://www.rbvi.ucsf.edu/chimerax/docs/user/tools/mousemodes.html" target="_none"><b>Right Mouse</b></a> 
tab of the toolbar or using the command:
			<blockquote style="text-align:left;margin-left:10px;font-size:90%">
<i>Command</i>:&nbsp;<b><a href="cxcmd:mouse right bond">mouse right bond</a></b>
			</blockquote>
<p>
With the assigned button,
click on the Tyr 248 CA-CB bond (closest to the ribbon) and drag to change chi1
interactively,
or on the CB-CG bond (the next one out, adjacent to the ring) to change chi2.
Any clashes are shown as bright purple pseudobonds and updated automatically
as the bond is rotated.
</section>

<section>
	<h1>Angles, Rotamers, Clashes</h1>
	<div style="height:850px; font-size:80%">
<p><b>Close</b> the <b>Clashes</b> dialog.
If clash pseudobonds are still shown, remove them:
			<blockquote style="text-align:left;margin-left:10px;font-size:90%">
				<i>Command</i>:&nbsp;<b><a href="cxcmd:~clashes">~clashes</a></b>
			</blockquote>
<p>
Restore the original chi1 and chi2 angles of Tyr248:
			<blockquote style="text-align:left;margin-left:10px;font-size:90%">
				<i>Command</i>:&nbsp;<b><a href="cxcmd:torsion :248@n,ca,cb,cg -106.801">torsion :248@n,ca,cb,cg -106.801</a></b>
				<br><i>Command</i>:&nbsp;<b><a href="cxcmd:torsion :248@ca,cb,cg,cd1 -142.054">torsion :248@ca,cb,cg,cd1 -142.054</a></b>
			</blockquote>
<p>
Next, we will compare the conformation of Tyr 248 in the structure to tyrosine 
rotamers from a library. With Tyr 248 still selected (if not, Ctrl-click it), 
start the
<b><a href="https://www.rbvi.ucsf.edu/chimerax/docs/user/tools/rotamers.html" target="_none">Rotamers</a></b> tool:
			<blockquote style="text-align:left;margin-left:10px;font-size:90%">
				<i>Command</i>:&nbsp;<b><a href="cxcmd:tool show Rotamers">tool show Rotamers</a></b>
			</blockquote>
<p>In the resulting dialog,
click <b>OK</b> to show TYR rotamers from the Dunbrack library.
</section>

<section>
	<h1>Angles, Rotamers, Clashes</h1>
	<div style="height:850px; font-size:80%">
<a href="modules/chimerax-comp-structures/rotamer-list.png">
<img class="plain" style="border: solid black 1px" width="400px" align="right"
title="click to enlarge..."
src="modules/chimerax-comp-structures/rotamer-list.png"/></a>
<p>
The dialog lists rotamer
sidechain (chi) angles and probabilities from the library.
The rotamers are displayed, and you can see that none
matches the original conformation of Tyr 248
(chi1 &ndash;107&deg;, chi2 &ndash;142&deg;). 
Specific rotamers can be shown by clicking/dragging to choose rows in the list.
<p>
The probabilities are based only on the residue's backbone angles
(given in the <b>Log</b>: phi &ndash;74&deg; and psi &ndash;32.2&deg;),
NOT on any interactions with the rest of the structure.
Use the rotamer dialog to calculate
<b>H-bonds</b> and <b>Clashes</b> with default settings.
The new columns show that each rotamer forms several clashes but no H-bonds.
Earlier in the tutorial, we found
that Tyr 248 H-bonds with ligand and avoids clashes, 
which may compensate for its nonrotameric (presumably strained) conformation.
</section>

<section>
	<h1>Angles, Rotamers, Clashes</h1>
	<div style="height:850px; font-size:80%">
<p>
A sidechain can be replaced with a rotamer of the same amino acid type
or &ldquo;mutated&rdquo; to a different type. 
With a single rotamer chosen in the dialog,
either click <b>Use Chosen Rotamer(s)</b> to replace the sidechain 
with that rotamer or <b>Cancel</b> to close the dialog
without changing the structure.
<p>
Unlike Tyr 248, Tyr 41 resembles the two highest-probability tyrosine 
rotamers given its backbone angles. If you like, 
<a href="cxcmd:view :41">focus the view on Tyr 41</a>, 
Ctrl-click to select one of its atoms or bonds, and
<a href="cxcmd:tool show Rotamers">use <b>Rotamers</b></a>
to show and evaluate rotamers of tyrosine 
or some other type of amino acid at that position. 
<p>
When finished with
<b><a href="https://www.rbvi.ucsf.edu/chimerax/docs/user/tools/rotamers.html" target="_none">Rotamers</a></b>, click <b>Cancel</b> on
the rotamer dialog. Clean up for the next section and zoom back out:
			<blockquote style="text-align:left;margin-left:10px;font-size:90%">
				<i>Command</i>:&nbsp;<b><a href="cxcmd:select clear">select clear</a></b>
				<br><i>Command</i>:&nbsp;<b><a href="cxcmd:label delete">label delete</a></b>
				<br><i>Command</i>:&nbsp;<b><a href="cxcmd:~hbonds; ~clashes">~hbonds; ~clashes</a></b>
				<br><i>Command</i>:&nbsp;<b><a href="cxcmd:view">view</a></b>
			</blockquote>
</section>

<section id="surfaces">
	<h1>Surfaces and Attributes</h1>
	<div style="height:850px; font-size:80%">
<p>
FPS and the natural substrate both have a highly polar/charged 
&ldquo;head&rdquo; and a long hydrocarbon &ldquo;tail.&rdquo;
The enzyme pocket is very large and deep,
as needed to accommodate two of these molecules.  
</p>

<p>
A surface representation is best for showing the shape of the pocket.  
ChimeraX provides a command that calculates the molecular lipophilicity potential (MLP) map for proteins.
Either click on the &ldquo;color by hydrophobicity&rdquo;
<img width="30px" src="modules/chimerax-comp-structures/mlpbutton.png"/> icon
in the <a href="https://www.rbvi.ucsf.edu/chimerax/docs/user/tools/moldisplay.html" target="_none"><b>Molecule Display</b></a> tab of the toolbar or use the 
<b><a href="https://www.rbvi.ucsf.edu/chimerax/docs/user/commands/mlp.html" target="_none">mlp</a></b> command:
			<blockquote style="text-align:left;margin-left:10px;font-size:90%">
				<i>Command</i>:&nbsp;<b><a href="cxcmd:mlp">mlp</a></b>
			</blockquote>
</p>
<p>
This shows a molecular surface and colors it
from dark cyan for most hydrophilic (least hydrophobic) areas, through white,
to dark goldenrod for the most lipophilic (most hydrophobic).
</p>
	</div>
</section>

<section>
	<h1>Surfaces and Attributes</h1>
	<div style="width:400px;height:300px;float:right;margin-top:0px">
			<img class="plain" src="modules/chimerax-comp-structures/hydropocket.png"/>
	</div>
	<div style="height:850px; font-size:80%">

<p>
As expected, the mouth of the pocket near the phosphates and ions is 
mostly polar, while the rest of the pocket is largely hydrophobic.  
However, the pocket is so deep that it is hard to see when the whole surface 
is shown. Showing just the pocket region allows viewing it from the outside.
</p><p>
Limit protein surface display to atoms within 6.3 &Aring; of ligand and show only the largest patch:
</p>
<blockquote style="text-align:left;margin-left:10px;font-size:90%">
<i>Command</i>:&nbsp;<b><a href="cxcmd:surface ligand @<6.3 visiblePatches 1">surface ligand @&lt;6.3 visiblePatches 1</a></b>
</blockquote>
<!-- alternative command; bug with max option fixed 11/18/2019
<p>
Limit protein surface to display a 5-&Aring; zone around the ligand:
</p>
<blockquote style="text-align:left;margin-left:10px;font-size:90%">
<i>Command</i>:&nbsp;<b><a href="cxcmd:surf zone #1 near ligand dist 5 max 1">surf zone #1 near ligand dist 5 max 1</a></b>
</blockquote>
-->
<p>
Hide the ribbon and the protein atoms: 
</p>
<blockquote style="text-align:left;margin-left:10px;font-size:90%">
<i>Command</i>:&nbsp;<b><a href="cxcmd:hide ribbon">hide ribbon</a></b>
<br>
<i>Command</i>:&nbsp;<b><a href="cxcmd:hide protein">hide protein</a></b>
</blockquote>
	</div>
</section>
	
<section>
	<h1>Surfaces and Attributes</h1>
	<div style="height:850px; font-size:80%">
	<p>
	Amino acid hydrophobicity is one example of an 
	<b><i><a href="https://www.rbvi.ucsf.edu/chimerax/docs/user/attributes.html" target="_none">attribute</a></i></b>.
Another attribute commonly used in structure analysis is atomic
B-factor.  B-factor values indicate which parts of the structure
are more or less flexible or disordered.  
</p><p>
Display all atoms by choosing <b>Presets... Sticks</b>
from the menu or by using the command:
</p>
<blockquote style="text-align:left;margin-left:10px;font-size:90%">
<i>Command</i>:&nbsp;<b><a href="cxcmd:preset sticks">preset sticks</a></b>
</blockquote>
<p>
Now the atoms are shown as sticks. Show the ligands as spheres:
<blockquote style="text-align:left;margin-left:10px;font-size:90%">
<i>Command</i>:&nbsp;<b><a href="cxcmd:style ligand sphere">style ligand sphere</a></b>
</blockquote>
<p>The <b><a href="https://www.rbvi.ucsf.edu/chimerax/docs/user/commands/style.html" target="_none">style</a></b> command sets atom/bond display styles.</p>
	</div>
</section>

<section>
	<h1>Surfaces and Attributes</h1>
	<div style="width:400px;height:300px;float:right;margin-top:0px">
			<img class="plain" src="modules/chimerax-comp-structures/bfactor.png"/>
	</div>
	<div style="height:850px; font-size:80%">
<p>
The <a href="https://www.rbvi.ucsf.edu/chimerax/docs/user/commands/color.html" target="_none"><b>color</b></a> command 
provides a number of options for coloring structures, including coloring by attribute.
Color the structure by B-factor:
</p>
<blockquote style="text-align:left;margin-left:10px;font-size:90%">
<i>Command</i>:&nbsp;<b><a href="cxcmd:color byattribute bfactor">color byattribute bfactor</a></b>
</blockquote>
<p>The lowest B-factors (blue) are in the protein core, the highest (red)
in a loop over the active site and the C-terminus on the opposite side.
Different color mappings could be applied, for example:
<blockquote style="text-align:left;margin-left:10px;font-size:90%">
<i>Command</i>:&nbsp;<b><a href="cxcmd:color byattribute bfactor palette rainbow range 25,75">color byattribute bfactor palette rainbow range 25,75</a></b>
</blockquote>
<p>
B-factor is an atom attribute, but residue and model attributes can also
be used for coloring.
	</div>
</section>

<section id="comparison">
	<h1>Superposition and Morphing</h1>
	<div style="width:400px;height:300px;float:right;margin-top:0px">
			<img class="plain" src="modules/chimerax-comp-structures/modelpanel.png"/>
	</div>
	<div style="height:850px; font-size:80%">
<p>
Comparing different structures of a protein is another way to evaluate
flexibility.  We have been viewing a structure bound to substrate analogs,
<b>3w7f</b>.  A structure of the same enzyme without ligands is also available.
Fetch the &ldquo;empty&rdquo; structure and apply the default (original look) preset:
<blockquote style="text-align:left;margin-left:10px;font-size:90%">
			<i>Command</i>:&nbsp;<b><a href="cxcmd:open 2zco">open 2zco</a></b>
<br>
			<i>Command</i>:&nbsp;<b><a href="cxcmd:preset original">preset original</a></b>
</blockquote>
<p>
Now the first structure is tan and the new structure is sky blue, as shown in 
the <a href="https://www.rbvi.ucsf.edu/chimerax/docs/user/tools/modelpanel.html" target="_none"><b>Model Panel</b></a> 
(<b>Tools... General... Model Panel</b>).  
</p>
	</div>
</section>

<section>
	<h1>Superposition and Morphing</h1>
	<div style="height:850px; font-size:80%">
<p>
The structures are in completely different positions, 
so the next step is to superimpose them. This is easily accomplished with the
<a href="https://www.rbvi.ucsf.edu/chimerax/docs/user/commands/matchmaker.html" target="_none"><b>matchmaker</b></a>
command (same as
<a href="https://www.rbvi.ucsf.edu/chimerax/docs/user/commands/matchmaker.html" target="_none"><b>mmaker</b></a>).
<blockquote style="text-align:left;margin-left:10px;font-size:90%">
	<i>Command</i>:&nbsp;<b><a href="cxcmd:mm #2 to #1 showAlignment true">mm #2 to #1 showAlignment true</a></b>
</blockquote>
<img class="plain" width="700px" src="modules/chimerax-comp-structures/mm.png"/>
	</div>
</section>

<section>
	<h1>Superposition and Morphing</h1>

	<div style="height:850px; font-size:70%">
		<h3 style="text-align:left">Matchmaker details</h3>
<p><b>MatchMaker</b> first generates a sequence alignment using both
residue types and 
secondary structure (tries to align helix with helix and strand with strand),
then fits the sequence-aligned residues in 3D by pairing their CA atoms.
The <b>showAlignment true</b> option displays the sequence alignment.
By default, the fit is iterated so that far-apart pairs are not included 
in the final match. This allows the most similar parts to superimpose
more tightly and the dissimilar parts to stand out.
Final match statistics are reported in the <b>Log</b>,
and the pairs used in the final fit are shown with
<font style="background:rgb(255,224,204);
border:solid orangered 1px;padding:1px 3px">
light orange boxes</font>
on the sequence alignment. 
<!--
	The RMSD histogram
above the sequences shows spatial variability, calculated as the
root-mean-square deviation among the CA atoms of residues associated 
with each column. In this case (only two structures),
the RMSD value is the same as the CA-CA distance. 
-->
</p>

	</div>

</section>

<section>
	<h1>Superposition and Morphing</h1>
	<div style="width:400px;height:300px;float:right;margin-top:0px">
			<img class="plain" src="modules/chimerax-comp-structures/premorph.png"/>
	</div>

	<div style="height:850px; font-size:70%">
<p>
The structures are highly similar except for the loop at approximately 
residues 52-56; you can see residue numbers by clicking into the
sequence alignment window and hovering the cursor over the corresponding 
one-letter codes. In that window, click any part of the
<font style="background:rgb(255,224,204);
border:solid orangered 1px;padding:1px 3px">
light orange boxes</font>
to select all the residues used in the final fit; 
these form the common core, the most conformationally similar parts
of the structures. The selection can be inverted if you want to do something
to the less similar parts, for example:
<blockquote style="text-align:left;margin-left:10px;font-size:90%">
<i>Command</i>:&nbsp;<b><a href="cxcmd:select ~sel">select &nbsp;~sel</a></b>
<br>
<i>Command</i>:&nbsp;<b><a href="cxcmd:disp sel & protein">disp sel &amp; protein</a></b>
<br>
<i>Command</i>:&nbsp;<b><a href="cxcmd:select clear">select clear</a></b>
</blockquote>
<p>The command <b>select ~sel</b> inverts the selection, and
	<b>disp sel &amp; protein</b> displays the selected atoms that are also classified as protein.
	The net effect is to show the side chains of the conformationally dissimilar loop.
	</p>
	</div>
</section>

<section>
	<h1>Superposition and Morphing</h1>
	<div style="width:400px;height:300px;float:right;margin-top:0px">
			<img class="plain" src="modules/chimerax-comp-structures/premorph.png"/>
	</div>

	<div style="height:850px; font-size:70%">
<p>
We want to morph between two states, the <i>bound</i> state (<b>3w7f</b>) 
and the <i>empty</i> state (<b>2zco</b>), using the
<b><i><a href="https://www.rbvi.ucsf.edu/chimerax/docs/user/commands/morph.html" target="_none">morph</a></i></b> command.
Morphing involves calculating a series of intermediate, interpolated
structures between the original input structures. The
series of structures is treated as a trajectory that can be replayed,
saved to a coordinate file, or saved as a movie. 
</p>
<blockquote style="text-align:left;margin-left:10px;font-size:90%">
			<i>Command</i>:&nbsp;<b><a href="cxcmd:morph #1,2 wrap true frames 60">
					morph #1,2 wrap true frames 60</a></b>
</blockquote>
<p>
The wrap option means to wrap around from the last model specified 
to the first, in this case, to morph from the bound to empty state and
then back to the bound state.
The command plays the morph trajectory once and shows a slider interface
that may be used to replay the trajectory or
to save it as an <i>MP4</i> movie.
Note that you will need to move the slider to the beginning manually 
to record the whole trajectory as a movie file.
	</p>
	</div>
</section>

<section>
	<h1>Morph Movie</h1>
	<p style="position:absolute;top:150px; left:220px; width: 400px">NOTE: won't play in Chimera's browser</p>
	<div style="height:850px;position:absolute;top:0px; left:200px">
	 <video controls autoplay loop>
  <source src="modules/chimerax-comp-structures/morph.mp4" type="video/mp4">
Your browser does not support the video tag.
</video>
	</div>
</section>

<section>
	<h1>Superposition and Morphing</h1>
	<div style="height:850px; font-size:60%">
	<p>
Although not all of the atoms in the morph are displayed at first,
all atoms that are present in both input structures 
are also present in the morph.
Their display can be controlled just as in any other structure, for example:
<blockquote style="text-align:left;margin-left:10px;font-size:90%">
	<i>Command</i>:&nbsp;<b><a href="cxcmd:show #3:lys">show&nbsp;#3:lys</a></b>
	<br><i>Command</i>:&nbsp;<b><a href="cxcmd:hide #3:lys">hide&nbsp;#3:lys</a></b>
</blockquote>
<p>
The ligand FPS was only present in one of the structures, <b>3w7f</b>,
so it is not included in the morph trajectory.
However, atoms from the original structures can be displayed 
along with the trajectory. Display of <b>3w7f</b> (model #1) 
can be re-enabled by checking the 
<img src="modules/chimerax-comp-structures/eye.png"/ class="plain" width="25px"> (shown) box in the
<a href="https://www.rbvi.ucsf.edu/chimerax/docs/user/tools/modelpanel.html"><target="_none">Model Panel</b></a> 
or with the command:
<blockquote style="text-align:left;margin-left:10px;font-size:90%">
<i>Command</i>:&nbsp;<b><a href="cxcmd:show #1 models">show #1 models</a></b>
</blockquote>
<p>Then, show only the ligand residues and ions from that model:</p>
<blockquote style="text-align:left;margin-left:10px;font-size:90%">
	<i>Command</i>:&nbsp;<b><a href="cxcmd:hide #1 surfaces,ribbons,atoms">hide&nbsp;#1&nbsp;surfaces,ribbons,atoms</a></b>
	<br><i>Command</i>:&nbsp;<b><a href="cxcmd:show #1:fps,mg">show&nbsp;#1:fps,mg</a></b>
</blockquote>
</p>
	</div>
	</section>
<section>
	<h1>Final Morph Movie</h1>
	<p style="position:absolute;top:150px; left:220px; width: 400px">NOTE: won't play in Chimera's browser</p>
	<div style="height:850px;position:absolute;top:0px; left:200px">
	 <video controls autoplay loop>
		 <source src="modules/chimerax-comp-structures/morph2.mp4" type="video/mp4" alt="Final morph movie">
Your browser does not support the video tag.
</video>
	</div>
</section>
